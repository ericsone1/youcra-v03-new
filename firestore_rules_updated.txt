rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {

    // ğŸ‘¤ ì‚¬ìš©ì í”„ë¡œí•„ â€“ ë¡œê·¸ì¸í•œ ë³¸ì¸ë§Œ ì½ê¸°/ì“°ê¸°, ë‹¤ë¥¸ ì‚¬ìš©ìëŠ” ì½ê¸°ë§Œ ê°€ëŠ¥
    match /users/{userId} {
      allow read: if request.auth != null;
      allow write: if request.auth != null && request.auth.uid == userId;
    }

    // ğŸ  ì±„íŒ…ë°© ì •ë³´ â€“ ëª¨ë“  ì¸ì¦ëœ ì‚¬ìš©ìê°€ ì½ê¸° ê°€ëŠ¥, ìƒì„±/ìˆ˜ì •ì€ ë³¸ì¸ë§Œ
    match /chatRooms/{roomId} {
      allow read: if request.auth != null;
      allow create: if request.auth != null;
      allow update: if request.auth != null;
      allow delete: if request.auth != null && 
        request.auth.uid == resource.data.createdBy;

      // ğŸ’¬ ì±„íŒ… ë©”ì‹œì§€ â€“ ëª¨ë“  ì¸ì¦ëœ ì‚¬ìš©ìê°€ ì½ê¸°/ì“°ê¸° ê°€ëŠ¥ (ê³µê°œ ì±„íŒ…ë°©)
      match /messages/{messageId} {
        allow read, write: if request.auth != null;
        
        // ğŸ“– ë©”ì‹œì§€ ì½ìŒ ìƒíƒœ ê´€ë¦¬
        match /readBy/{readerId} {
          allow read: if request.auth != null;
          allow write: if request.auth != null && request.auth.uid == readerId;
        }
      }

      // ğŸ‘¥ ì±„íŒ…ë°© ì°¸ì—¬ì â€“ ëª¨ë“  ì¸ì¦ëœ ì‚¬ìš©ìê°€ ì½ê¸°/ì“°ê¸° ê°€ëŠ¥
      match /participants/{userId} {
        allow read, write: if request.auth != null;
      }

      // ğŸ¥ ì±„íŒ…ë°© ë¹„ë””ì˜¤ â€“ ëª¨ë“  ì¸ì¦ëœ ì‚¬ìš©ìê°€ ì½ê¸°/ì“°ê¸° ê°€ëŠ¥
      match /videos/{videoId} {
        allow read, write: if request.auth != null;
      }
    }

    // ğŸ“Š ë¦¬í¬íŠ¸ â€“ ì½ê¸°ëŠ” ëª¨ë‘ ê°€ëŠ¥, ì“°ê¸°ëŠ” ì¸ì¦ëœ ì‚¬ìš©ìë§Œ
    match /reports/{reportId} {
      allow read: if true;
      allow write: if request.auth != null;
    }
  }
} 